!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).cmanvato=e()}}(function(){return function r(s,o,u){function c(t,e){if(!o[t]){if(!s[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var a=o[t]={exports:{}};s[t][0].call(a.exports,function(e){return c(s[t][1][e]||e)},a,a.exports,r,s,o,u)}return o[t].exports}for(var l="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,n){t.exports={name:"cm-anvato",version:"3.1.6",main:"src/anvato.js",private:!0,dependencies:{},devDependencies:{grunt:"^1.0.3","grunt-browserify":"^5.3.0","grunt-contrib-jshint":"^1.1.0","grunt-contrib-uglify":"^3.4.0",matchdep:"^2.0.0","methode-publishing":"github:coxmediagroup/methode-publishing#v1.2.0"},repository:{type:"git",url:"git+https://github.com/coxmediagroup/cm-anvato.git"},author:"Dan Cobb <dan.cobb@coxinc.com>",cmg:{root:"/PortalConfig/common/video/"}}},{}],2:[function(e,t,n){var i=e("./load-players.js"),a=e("./extensions/dtm.js"),r=e("./extensions/chartbeat/setup.js"),s=e("./util/player-cache.js"),o=e("./util/event-handler.js"),u=e("./util/init-plugins.js");t.exports={get:function(t){return{then:function(e){s.get(t,e)}}},on:o.on,setup:function(){e("./set-common-config.js"),r(),a(),i()},loadPlayers:i,setupMetrics:a,set:function(e,t){var n=window.anvp=window.anvp||{};n.common=n.common||{},n.common.config=n.common.config||{},n.common.config[e]=t},setPlayerInitPlugins:function(e,t){u.set(e,t)},pauseAll:e("./pause-all.js")}},{"./extensions/chartbeat/setup.js":6,"./extensions/dtm.js":10,"./load-players.js":13,"./pause-all.js":14,"./set-common-config.js":15,"./util/event-handler.js":17,"./util/init-plugins.js":19,"./util/player-cache.js":25}],3:[function(e,t,n){var o=e("../extensions/dfp.js"),u=e("../util/environment-options.js"),c=e("../util/scrub-metadata.js");t.exports=function(e,a,r){var s=0;e.on("beforeVideoLoad",function(e,t){var n=t.plugins.dfp;if(u.noads||void 0===n||void 0===n.clientSide||"MCP_ENFORCED_DISABLE"===n.clientSide.adTagUrl)return console.warn("[cmAnvato] Pre-roll DISABLE was requested for player",a),!1;s+=1;var i=o(c(e),a,r.getAttribute("data-cmsid")||window.cmg.anvatoConf.cmsid,n.clientSide.adTagUrl,window.parseInt(r.getAttribute("data-dfp-timeout")),r.getAttribute("data-adunit"),1===s?r.getAttribute("data-topics"):[],1===s?r.getAttribute("data-categories"):[]);return i?t.plugins.dfp.clientSide=i:console.warn("[cmAnvato] was not able to build client-side ad config. Using initial configs for player",a),t})}},{"../extensions/dfp.js":9,"../util/environment-options.js":16,"../util/scrub-metadata.js":26}],4:[function(e,t,n){t.exports=function(e,t){e.on("ready",function(){window._cbv=window._cbv||[],window._cbv.push(e),t&&e.mute()})}},{}],5:[function(e,t,n){t.exports=function(i){i.cmg={ready:!1,contentType:"ct",currentTime:0},i.on("ready",function(){window.setInterval(function(){i.getCurrentTime(function(e){i.cmg.currentTime=1e3*e})},500)}),i.on("METADATA_LOADED",function(e,t,n){i.cmg.firstplay=void 0===i.cmg.firstplay,i.cmg.ready=!0,i.cmg.startTime=!1,i.cmg.state=e===i.cmg.video?"s4":"s1",i.cmg.video=e,i.cmg.title=n.title,i.cmg.duration=n.duration,i.cmg.thumbnail=n.thumbnail}),i.on("AD_STARTED",function(){i.cmg.contentType="ad",i.cmg.state="s2"}),i.on("VIDEO_STARTED",function(){i.cmg.contentType="ct"}),i.on("VIDEO_COMPLETED",function(){i.cmg.state="s4"}),i.on("PLAYING_START",function(){i.cmg.state="s2",i.cmg.startTime||(i.cmg.startTime=performance.now())}),i.on("USER_PAUSE",function(){i.cmg.state="s3"}),i.on("USER_RESUME",function(){i.cmg.state="s2"}),i.on("CLIENT_BANDWIDTH",function(e){i.cmg.bandwidth=e})}},{}],6:[function(e,t,n){var i=e("./strategy.js");t.exports=function(){window._cbv_strategies=window._cbv_strategies||[],window._cbv_strategies.push(i);var e=window.location.hostname,t=e.lastIndexOf(".",e.lastIndexOf(".")-1);window._sf_async_config=window._sf_async_config||{},window._sf_async_config.autoDetect=!1,window._sf_async_config.domain=e.substring(t+1),window._sf_async_config.uid=/ajc.com$/.test(e)?66001:31585,window._sf_async_config.useCanonical=!0,window._sf_endpt=window.Date.now();var n=document.createElement("script");n.src="https://static.chartbeat.com/js/chartbeat_video.js",document.body.appendChild(n)}},{"./strategy.js":7}],7:[function(e,t,n){t.exports=function(e){var t=e.cmg;return{isReady:function(){return t.ready},getTitle:function(){return t.title},getVideoPath:function(){return t.video},getContentType:function(){return t.contentType},getAdPosition:function(){return"a1"},getTotalDuration:function(){return 1e3*t.duration},getState:function(){return t.state},getCurrentPlayTime:function(){return Math.floor(t.currentTime)},getBitrate:function(){return Math.floor(t.bandwidth)||0},getThumbnailPath:function(){return t.thumbnail},getPlayerType:function(){return"VideoPlayer/Single"},getViewStartTime:function(){return t.startTime?Math.floor(performance.now()-t.startTime):0},getStrategyName:function(){return"AN"},getAutoplayType:function(){return t.firstplay?e.mergedConfig.autoplay?"auto":"man":"cont"}}},t.exports.verify=function(e){try{return 0<=e.mergedConfig.baseURL.indexOf("cdn.anvato.net")}catch(e){return!1}}},{}],8:[function(e,t,n){var i=window.cmg=window.cmg||{};i.adconf=i.adconf||{},i.adconf.targeting=i.adconf.targeting||{},i.anvatoConf=i.anvatoConf||{},t.exports=i},{}],9:[function(e,t,n){var f=e("./cmg.js"),h=e("../util/environment-options.js"),p=e("../../package.json").version;t.exports=function(e,t,n,i,a,r,s,o){var u;if(r||f.adconf.adunit){var c="large";innerWidth<500?c="small":innerWidth<900&&(c="medium");var l=[].concat(s||[],e.tags||[]).toString(),d=a||20;return u={adTagUrl:i,hideNonLinearAdsOnClose:!0,keyValues:{category:[].concat(o||[],e.categories||[]).toString(),video:e.upload_id,owner_id:e.owner_id,kw:l,topics:f.adconf.targeting.topics,weather:f.adconf.targeting.weather,temp_range:f.adconf.targeting.temp_range,sky:f.adconf.targeting.sky,obj_type:f.adconf.targeting.obj_type,obj_id:f.adconf.targeting.obj_id,uuid:f.adconf.targeting.uuid,player_id:t,environ:f.adconf.targeting.environ,overlaysize:c},loadVideoTimeout:"loadVideoTimeout"in h?parseInt(h.loadVideoTimeout):10,macros:{adunit:r||f.adconf.adunit,cmsid:n,vid:"ANV_ANV_"+e.upload_id,referrer_url:window.location.href},startTimeout:"startTimeout"in h?parseInt(h.startTimeout):d,useStyledNonLinearAds:!0,vastLoadTimeout:"vastLoadTimeout"in h?parseInt(h.vastLoadTimeout):10},console.info("\n/* -----====== VIDEO AD TARGETING LOG ("+t+") ======----- */\n"+e.def_title+"\n"+JSON.stringify(u.keyValues,null,3)+"\n\nCategory and Tag Information:\n-------------\n - Anvato MCP:\n\t[TAGS] "+e.tags+"\n\t[CATEGORIES] "+e.categories+"\n - VPX:\n\t[TOPICS] "+s+"\n\t[CATEGORIES] "+o+"\n - CMS PAGE:\n\t[TOPICS] "+f.adconf.targeting.topics+"\n\t[CATEGORIES] "+f.adconf.targeting.categories+"\n\nSystem Information:\n-------------\ncm-anvato version "+p+"\nAnvato player version "+window.anvp.version+"\n/* -----====== END VIDEO AD TARGETING LOG ("+t+") ======----- */"),u}console.warn("[cmAnvato] Cannot find cm-ads! Video ad targeting is OFFLINE.")}},{"../../package.json":1,"../util/environment-options.js":16,"./cmg.js":8}],10:[function(e,t,n){var i=e("../util/event-handler.js"),a={},r={};function s(t,n){var i=window.anvp[n];i.getCurrentTime(function(e){window.DDO.action(t,{videoContentType:i.mergedConfig.live?"live":"vod",videoId:r[n].videoid,videoName:r[n].title,videoPlayer:"Anvato Universal Player-"+n,videoPlayType:i.mergedConfig.autoplay?"auto-play":"manual play",videoSiteAccountID:i.mergedConfig.accessKey,videoSecondsViewed:Math.round(e),videoSource:"Anvato",videoTopics:r[n].tags,videoTotalTime:r[n].duration}),"videoComplete"===t&&i.mergedConfig.autoplayOnFirstComplete&&!i.mergedConfig.autoplay&&(i.mergedConfig.autoplay=!0)})}t.exports=function(){window.DDO&&window.DDO.action||console.warn("[cmAnvato] Cannot find DDO object! Video metrics are OFFLINE."),window.anvp=window.anvp||{},anvp.listener=function(e){if(i.trigger(e.name,e),window.DDO&&window.DDO.action){var t=e.sender;"METADATA_LOADED"===e.name?(r[t]||s("videoPlayerLoad",t),a[t]=!1,r[t]=r[t]||{},r[t].videoid=e.args[1],r[t].tags=e.args[2].tags,r[t].title=e.args[2].title,r[t].duration=e.args[2].duration):"AD_STARTED"===e.name?(s("videoAdStart",t),a[t]||(s("videoStart",t),a[t]=!0)):"AD_COMPLETED"===e.name||"AD_SKIPPED"===e.name?s("videoAdComplete",t):"VIDEO_STARTED"===e.name?(a[t]||(s("videoStart",t),a[t]=!0),s("videoContentPlay",t)):"USER_PAUSE"===e.name?s("videoPause",t):"TIME_UPDATED"===e.name&&e.args&&10===e.args[0]?s("videoViewCheckpoint",t):"VIDEO_FIRST_QUARTILE"===e.name?s("videoView25Checkpoint",t):"VIDEO_MID_POINT"===e.name?s("videoView50Checkpoint",t):"VIDEO_THIRD_QUARTILE"===e.name?s("videoView75Checkpoint",t):"VIDEO_COMPLETED"===e.name&&s("videoComplete",t)}}}},{"../util/event-handler.js":17}],11:[function(e,t,n){var i,a;i="undefined"!=typeof self?self:this,a=function(){return function(n){function i(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var a={};return i.m=n,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=8)}([function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.version=t.Core=t.VideoTrackerState=t.VideoTracker=t.Tracker=t.Emitter=t.Log=t.Chrono=t.Constants=void 0;var a=i(n(9)),r=i(n(10)),s=i(n(2)),o=i(n(1)),u=i(n(3)),c=i(n(4)),l=i(n(11)),d=i(n(6)),f=n(5);t.Constants=r.default,t.Chrono=s.default,t.Log=o.default,t.Emitter=u.default,t.Tracker=c.default,t.VideoTracker=l.default,t.VideoTrackerState=d.default,t.Core=a.default,t.version=f.version},function(e,t,n){"use strict";function i(e,t,n){t=t||s.Levels.NOTICE,n=n||"darkcyan";var i,a=s.prefix;if(s.includeTime&&(a+="["+("0"+(i=new Date).getDate()).slice(-2)+":"+("0"+i.getMinutes()).slice(-2)+":"+("0"+i.getSeconds()).slice(-2)+"."+("00"+i.getMilliseconds()).slice(-3)+"] "),a+=o[t]+":",s.level<=t&&t!==s.Levels.SILENT)if(!s.colorful||"undefined"!=typeof document&&document.documentMode)!function e(t,n){if(t instanceof Array)for(var i in t)e(t[i],n);else"string"==typeof t?console.log(n+" "+t):(console.log(n+"â†µ"),console.log(t))}(e,a);else{var r;r=t===s.Levels.ERROR&&console.error?console.error:t===s.Levels.WARNING&&console.warn?console.warn:t===s.Levels.DEBUG&&console.debug?console.debug:console.log,a="%c"+a,e.splice(0,0,a,"color: "+n),r.apply(console,e)}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),s=function(){function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r)}return a(r,null,[{key:"error",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i(t,r.Levels.ERROR,"darkred")}},{key:"warn",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i(t,r.Levels.WARNING,"darkorange")}},{key:"notice",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i([].slice.call(arguments),r.Levels.NOTICE,"darkcyan")}},{key:"debug",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i(t,r.Levels.DEBUG,"indigo")}},{key:"debugCommonVideoEvents",value:function(e,t,n){try{if(r.level<=r.Levels.DEBUG){n=n||function(e){r.debug("Event: "+e.type)};var i=["canplay","buffering","waiting","ended","play","playing","pause","resume","error","abort","seek","seeking","seeked","stalled","dispose","loadeddata","loadstart","loadedmetadata"];t&&(null===t[0]?(t.shift(),i=t):i=i.concat(t));for(var a=0;a<i.length;a++)"function"==typeof e?e.call(window,i[a],n):e.on?e.on(i[a],n):e.addEventListener?e.addEventListener(i[a],n):e.addEventHandler?e.addEventHandler(i[a],n):r.warn("debugCommonVideoEvents: No common listener function found for ",e)}}catch(e){r.warn(e)}}}]),r}();s.Levels={SILENT:5,ERROR:4,WARNING:3,NOTICE:2,DEBUG:1,ALL:0},s.level=s.Levels.ERROR,s.colorful=!0,s.includeTime=!0,s.prefix="[nrvideo]";var o={4:"e",3:"w",2:"n",1:"d"};!function(){if("undefined"!=typeof window&&window.location&&window.location.search){var e=/\?.*&*nrvideo-debug=(.+)/i.exec(window.location.search);null!==e&&("true"===e[1]?s.level=s.Levels.ALL:s.level=e[1]),null!==/\?.*&*nrvideo-colors=false/i.exec(window.location.search)&&(s.colorful=!1)}}(),t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=function(){function t(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),this.reset()}return i(t,[{key:"reset",value:function(){this.startTime=0,this.stopTime=0,this.offset=0}},{key:"getDeltaTime",value:function(){return this.startTime?this.offset+((new Date).getTime()-this.startTime):null}},{key:"start",value:function(){this.startTime=(new Date).getTime(),this.stopTime=0}},{key:"stop",value:function(){return this.stopTime=(new Date).getTime(),this.getDeltaTime()}},{key:"clone",value:function(){var e=new t;return e.startTime=this.startTime,e.stopTime=this.stopTime,e.offset=this.offset,e}}]),t}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"on",value:function(e,t){if(this._listeners=this._listeners||{},"function"==typeof t)return this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t),this}},{key:"off",value:function(e,t){if(this._listeners=this._listeners||{},this._listeners[e]){var n=this._listeners[e].indexOf(t);-1!==n&&this._listeners[e].splice(n,1)}return this}},{key:"emit",value:function(t,n){var i=this;return this._listeners=this._listeners||{},n=n||{},Array.isArray(this._listeners[t])&&this._listeners[t].forEach(function(e){e.call(i,{type:t,data:n,target:i})}),Array.isArray(this._listeners["*"])&&this._listeners["*"].forEach(function(e){e.call(i,{type:t,data:n,target:i})}),this}}]),e}();t.default=a},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(5)),s=i(n(3)),o=i(n(2)),u=function(e){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.customData={},t.heartbeat=null,t.parentTracker=null,t._trackerReadyChrono=new o.default,t._trackerReadyChrono.start(),e=e||{},t.setOptions(e),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,s.default),a(n,[{key:"setOptions",value:function(e){e&&(e.parentTracker&&(this.parentTracker=e.parentTracker),e.customData&&(this.customData=e.customData),e.heartbeat&&(this.heartbeat=e.heartbeat))}},{key:"dispose",value:function(){this.unregisterListeners()}},{key:"registerListeners",value:function(){}},{key:"unregisterListeners",value:function(){}},{key:"getHeartbeat",value:function(){return this.heartbeat?this.heartbeat:this.parentTracker&&this.parentTracker.heartbeat?this.parentTracker.heartbeat:3e4}},{key:"startHeartbeat",value:function(){this._heartbeatInterval=setInterval(this.sendHeartbeat.bind(this),Math.max(this.getHeartbeat(),5e3))}},{key:"stopHeartbeat",value:function(){this._heartbeatInterval&&clearInterval(this._heartbeatInterval)}},{key:"sendHeartbeat",value:function(e){this.send(n.Events.HEARTBEAT,e)}},{key:"getAttributes",value:function(e){for(var t in(e=e||{}).trackerName=this.getTrackerName(),e.trackerVersion=this.getTrackerVersion(),e.coreVersion=r.version,e.timeSinceTrackerReady=this._trackerReadyChrono.getDeltaTime(),this.customData)e[t]=this.customData[t];return e}},{key:"getTrackerVersion",value:function(){return r.version}},{key:"getTrackerName",value:function(){return"base-tracker"}},{key:"send",value:function(e,t){this.emit(e,this.getAttributes(t))}}]),n}();u.Events={HEARTBEAT:"HEARTBEAT"},t.default=u},function(e,t){e.exports={_from:"github:newrelic/video-core-js#v0.9.3",_id:"newrelic-video-core@0.9.3",_inBundle:!1,_location:"/newrelic-video-core",_phantomChildren:{},_requested:{type:"git",raw:"newrelic-video-core@github:newrelic/video-core-js#v0.9.3",name:"newrelic-video-core",escapedName:"newrelic-video-core",rawSpec:"github:newrelic/video-core-js#v0.9.3",saveSpec:"github:newrelic/video-core-js#v0.9.3",fetchSpec:null,gitCommittish:"v0.9.3"},_requiredBy:["/"],_resolved:"github:newrelic/video-core-js#66c5a9f33c7ff04f5e47548a2efe340769602545",_spec:"newrelic-video-core@github:newrelic/video-core-js#v0.9.3",_where:"/Users/jaguilargorina/workspace/nrvideo/trackers/anvato",author:{name:"Jordi Aguilar"},bugs:{url:"https://github.com/newrelic/video-core-js/issues"},bundleDependencies:!1,dependencies:{},deprecated:!1,description:"New Relic video tracking core library",devDependencies:{"aws-sdk":"^2.150.0","babel-core":"^6.25.0","babel-loader":"^7.1.1","babel-preset-env":"^1.6.0",chai:"^4.1.0","ink-docstrap":"^1.3.0",jsdoc:"^3.5.4","jsdoc-babel":"^0.3.0",mocha:"^3.5.0",nyc:"^11.1.0",sinon:"^2.4.1",webpack:"^3.4.1"},homepage:"https://github.com/newrelic/video-core-js#readme",license:"MIT",main:"src/index.js",name:"newrelic-video-core",repository:{type:"git",url:"git+https://github.com/newrelic/video-core-js.git"},scripts:{build:"webpack -p","build:dev":"webpack",clean:"rm -rf dist coverage doc",deploy:"node scripts/deploy.js",doc:"jsdoc -c jsdoc.json -d doc",test:"nyc --reporter=html --reporter=text mocha --compilers js:babel-core/register",watch:"webpack -p --progress --color --watch","watch:dev":"webpack --progress --color --watch"},version:"0.9.3"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=n(2),s=(i=r)&&i.__esModule?i:{default:i},o=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.reset(),this._createdAt=Date.now()}return a(e,[{key:"reset",value:function(){this._viewSession=null,this._viewCount=0,this._isAd=!1,this.numberOfErrors=0,this.numberOfAds=0,this.numberOfVideos=0,this.resetFlags(),this.resetChronos()}},{key:"resetFlags",value:function(){this.isPlayerReady=!1,this.isRequested=!1,this.isStarted=!1,this.isPaused=!1,this.isSeeking=!1,this.isBuffering=!1,this.isAdBreak=!1}},{key:"resetChronos",value:function(){this.timeSinceRequested=new s.default,this.timeSinceStarted=new s.default,this.timeSincePaused=new s.default,this.timeSinceSeekBegin=new s.default,this.timeSinceBufferBegin=new s.default,this.timeSinceAdBreakStart=new s.default,this.timeSinceLastDownload=new s.default,this.timeSinceLastHeartbeat=new s.default,this.timeSinceLastRenditionChange=new s.default,this.timeSinceLastAdQuartile=new s.default,this.timeSinceLastAd=new s.default}},{key:"isAd",value:function(){return this._isAd}},{key:"setIsAd",value:function(e){this._isAd=e}},{key:"getViewSession",value:function(){if(!this._viewSession){var e=(new Date).getTime(),t=Math.random().toString(36).substring(2)+Math.random().toString(36).substring(2);this._viewSession=e+"-"+t}return this._viewSession}},{key:"getViewId",value:function(){return this.getViewSession()+"-"+this._viewCount}},{key:"getStateAttributes",value:function(e){return e=e||{},this.isAd()?(this.isRequested&&(e.timeSinceAdRequested=this.timeSinceRequested.getDeltaTime(),e.timeSinceLastAdHeartbeat=this.timeSinceLastHeartbeat.getDeltaTime()),this.isStarted&&(e.timeSinceAdStarted=this.timeSinceStarted.getDeltaTime()),this.isPaused&&(e.timeSinceAdPaused=this.timeSincePaused.getDeltaTime()),this.isBuffering&&(e.timeSinceAdBufferBegin=this.timeSinceBufferBegin.getDeltaTime()),this.isSeeking&&(e.timeSinceAdSeekBegin=this.timeSinceSeekBegin.getDeltaTime()),this.isAdBreak&&(e.timeSinceAdBreakBegin=this.timeSinceAdBreakStart.getDeltaTime()),e.numberOfAds=this.numberOfAds):(this.isRequested&&(e.timeSinceRequested=this.timeSinceRequested.getDeltaTime(),e.timeSinceLastHeartbeat=this.timeSinceLastHeartbeat.getDeltaTime()),this.isStarted&&(e.timeSinceStarted=this.timeSinceStarted.getDeltaTime()),this.isPaused&&(e.timeSincePaused=this.timeSincePaused.getDeltaTime()),this.isBuffering&&(e.timeSinceBufferBegin=this.timeSinceBufferBegin.getDeltaTime()),this.isSeeking&&(e.timeSinceSeekBegin=this.timeSinceSeekBegin.getDeltaTime()),e.timeSinceLastAd=this.timeSinceLastAd.getDeltaTime(),e.numberOfVideos=this.numberOfVideos),e.numberOfErrors=this.numberOfErrors,e}},{key:"goViewCountUp",value:function(){this._viewCount++}},{key:"goPlayerReady",value:function(){return!this.isPlayerReady&&(this.isPlayerReady=!0)}},{key:"goRequest",value:function(){return!this.isRequested&&(this.isRequested=!0,this.timeSinceLastAd.reset(),this.timeSinceRequested.start(),!0)}},{key:"goStart",value:function(){return!(!this.isRequested||this.isStarted||(this.isAd()?this.numberOfAds++:this.numberOfVideos++,this.isStarted=!0,this.timeSinceStarted.start(),0))}},{key:"goEnd",value:function(){return!!this.isRequested&&(this.numberOfErrors=0,this.resetFlags(),this.timeSinceRequested.stop(),this.timeSinceStarted.stop(),!0)}},{key:"goPause",value:function(){return!(!this.isStarted||this.isPaused||(this.isPaused=!0,this.timeSincePaused.start(),0))}},{key:"goResume",value:function(){return!(!this.isStarted||!this.isPaused||(this.isPaused=!1,this.timeSincePaused.stop(),0))}},{key:"goBufferStart",value:function(){return!(!this.isStarted||this.isBuffering||(this.isBuffering=!0,this.timeSinceBufferBegin.start(),0))}},{key:"goBufferEnd",value:function(){return!(!this.isStarted||!this.isBuffering||(this.isBuffering=!1,this.timeSinceBufferBegin.stop(),0))}},{key:"goSeekStart",value:function(){return!(!this.isStarted||this.isSeeking||(this.isSeeking=!0,this.timeSinceSeekBegin.start(),0))}},{key:"goSeekEnd",value:function(){return!(!this.isStarted||!this.isSeeking||(this.isSeeking=!1,this.timeSinceSeekBegin.stop(),0))}},{key:"goAdBreakStart",value:function(){return!this.isAdBreak&&(this.isAdBreak=!0,this.timeSinceAdBreakStart.start(),!0)}},{key:"goAdBreakEnd",value:function(){return!!this.isAdBreak&&(this.isAdBreak=!1,this.timeSinceAdBreakStart.stop(),!0)}},{key:"goDownload",value:function(){this.timeSinceLastDownload.start()}},{key:"goHeartbeat",value:function(){this.timeSinceLastHeartbeat.start()}},{key:"goRenditionChange",value:function(){this.timeSinceLastRenditionChange.start()}},{key:"goAdQuartile",value:function(){this.timeSinceLastAdQuartile.start()}},{key:"goError",value:function(){this.numberOfErrors++}},{key:"goLastAd",value:function(){this.timeSinceLastAd.start()}}]),e}();t.default=o},function(e,t){e.exports={name:"newrelic-video-anvato",version:"0.1.0",description:"New relic tracker for anvato",main:"src/index.js",scripts:{build:"webpack -p","build:dev":"webpack",watch:"webpack -p --progress --color --watch","watch:dev":"webpack --progress --color --watch",prezip:"npm run build && rm -f dist/*.map",zip:"zip -P newrelic -x '*.DS_Store' -x 'samples/agent.js' -r anvato.zip dist samples README.md CHANGELOG.md EULA.md",clean:"rm -rf dist *.zip",deploy:"node scripts/deploy.js"},repository:{type:"git",url:"https://github.com/newrelic/video-anvato-js.git"},author:"Jordi Aguilar",license:"MIT",dependencies:{"newrelic-video-core":"github:newrelic/video-core-js#v0.9.3"},devDependencies:{"aws-sdk":"^2.157.0","babel-core":"^6.25.0","babel-loader":"^7.1.1","babel-preset-env":"^1.6.0","videojs-ima":"^0.6.0",webpack:"^3.4.1"}}},function(e,t,n){"use strict";var i,a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),r=n(12),s=(i=r)&&i.__esModule?i:{default:i};a.AnvatoTracker=s.default,e.exports=a},function(e,t,n){"use strict";function i(e){var t=function(e){var t={};for(var n in e)null!==e[n]&&void 0!==e[n]&&(t[n]=e[n]);return t}(e.data);o.default.level<=o.default.Levels.DEBUG?o.default.notice("Sent",e.type,t):o.default.notice("Sent",e.type),u.send(e.type,t)}Object.defineProperty(t,"__esModule",{value:!0});var a,r=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),s=n(1),o=(a=s)&&a.__esModule?a:{default:a},u=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"addTracker",value:function(e){e.on&&e.emit?(c.push(e),e.on("*",i)):o.default.error("Tried to load a non-tracker.",e)}},{key:"removeTracker",value:function(e){e.off("*",i),e.dispose();var t=c.indexOf(e);-1!==t&&c.splice(t,1)}},{key:"getTrackers",value:function(){return c}},{key:"send",value:function(e,t){"undefined"!=typeof newrelic&&newrelic.addPageAction?newrelic.addPageAction(e,t):l||(o.default.error("newrelic.addPageAction() is not available.","In order to use NewRelic Video you will need New Relic Browser Agent."),l=!0)}},{key:"sendError",value:function(e){t.send("ERROR",e)}}]),t}(),c=[],l=!1;t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};i.AdPositions={PRE:"pre",MID:"mid",POST:"post"},t.default=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function a(e){this.send(e.type,e.data)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),s=i(n(1)),o=i(n(4)),u=i(n(6)),c=function(e){function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return n.state=new u.default,n.adsTracker=null,t=t||{},n.setOptions(t),e&&n.setPlayer(e,t.tag),s.default.notice("Tracker "+n.getTrackerName()+" v"+n.getTrackerVersion()+" is ready."),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,o.default),r(i,[{key:"setOptions",value:function(e){e&&(e.adsTracker&&this.setAdsTracker(e.adsTracker),"boolean"==typeof e.isAd&&this.setIsAd(e.isAd),o.default.prototype.setOptions.apply(this,arguments))}},{key:"setPlayer",value:function(e,t){(this.player||this.tag)&&this.dispose(),"undefined"!=typeof document&&document.getElementById&&("string"==typeof e&&(e=document.getElementById(e)),"string"==typeof t&&(t=document.getElementById(t))),t=t||e,this.player=e,this.tag=t,this.registerListeners()}},{key:"isAd",value:function(){return this.state.isAd()}},{key:"setIsAd",value:function(e){this.state.setIsAd(e)}},{key:"setAdsTracker",value:function(e){this.disposeAdsTracker(),e&&(this.adsTracker=e,this.adsTracker.setIsAd(!0),(this.adsTracker.parentTracker=this).adsTracker.on("*",a.bind(this)))}},{key:"disposeAdsTracker",value:function(){this.adsTracker&&(this.adsTracker.off("*",a),this.adsTracker.dispose())}},{key:"dispose",value:function(){this.stopHeartbeat(),this.disposeAdsTracker(),this.unregisterListeners(),this.player=null,this.tag=null}},{key:"registerListeners",value:function(){}},{key:"unregisterListeners",value:function(){}},{key:"getViewId",value:function(){return this.parentTracker?this.parentTracker.getViewId():this.state.getViewId()}},{key:"getViewSession",value:function(){return this.parentTracker?this.parentTracker.getViewSession():this.state.getViewSession()}},{key:"getVideoId",value:function(){return null}},{key:"getTitle",value:function(){return null}},{key:"isLive",value:function(){return null}},{key:"getBitrate",value:function(){return null}},{key:"getWebkitBitrate",value:function(){if(this.tag&&this.tag.webkitVideoDecodedByteCount){var e=void 0;if(this._lastWebkitBitrate){var t=(e=this.tag.webkitVideoDecodedByteCount)-this._lastWebkitBitrate,n=this.getHeartbeat()/1e3;e=Math.round(t/n*8)}return this._lastWebkitBitrate=this.tag.webkitVideoDecodedByteCount,e||null}}},{key:"getRenditionName",value:function(){return null}},{key:"getRenditionBitrate",value:function(){return null}},{key:"getRenditionShift",value:function(e){var t=this.getRenditionBitrate(),n=void 0;return this.isAd()?(n=this._lastAdRendition,e&&(this._lastAdRendition=t)):(n=this._lastRendition,e&&(this._lastRendition=t)),t&&n?n<t?"up":t<n?"down":null:null}},{key:"getRenditionHeight",value:function(){return this.tag?this.tag.videoHeight:null}},{key:"getRenditionWidth",value:function(){return this.tag?this.tag.videoWidth:null}},{key:"getDuration",value:function(){return this.tag?this.tag.duration:null}},{key:"getPlayhead",value:function(){return this.tag?this.tag.currentTime:null}},{key:"getLanguage",value:function(){return null}},{key:"getSrc",value:function(){return this.tag?this.tag.currentSrc:null}},{key:"getPlayrate",value:function(){return this.tag?this.tag.playbackRate:null}},{key:"isMuted",value:function(){return this.tag?this.tag.muted:null}},{key:"isFullscreen",value:function(){return null}},{key:"getCdn",value:function(){return null}},{key:"getPlayerName",value:function(){return this.getTrackerName()}},{key:"getPlayerVersion",value:function(){return null}},{key:"getFps",value:function(){return null}},{key:"isAutoplayed",value:function(){return this.tag?this.tag.autoplay:null}},{key:"getPreload",value:function(){return this.tag?this.tag.preload:null}},{key:"getAdQuartile",value:function(){return null}},{key:"getAdPosition",value:function(){return this.state.isStarted?"pre":"mid"}},{key:"getAdPartner",value:function(){return null}},{key:"getAdCreativeId",value:function(){return null}},{key:"getAttributes",value:function(e){void 0===(e=o.default.prototype.getAttributes.apply(this,arguments)).isAd&&(e.isAd=this.isAd()),e.viewSession=this.getViewSession(),e.viewId=this.getViewId(),e.playerName=this.getPlayerName(),e.playerVersion=this.getPlayerVersion();try{e.pageUrl=window.location.href}catch(e){}for(var t in this.isAd()?(e.adId=this.getVideoId(),e.adTitle=this.getTitle(),e.adBitrate=this.getBitrate()||this.getWebkitBitrate(),e.adRenditionName=this.getRenditionName(),e.adRenditionBitrate=this.getRenditionBitrate(),e.adRenditionHeight=this.getRenditionHeight(),e.adRenditionWidth=this.getRenditionWidth(),e.adDuration=this.getDuration(),e.adPlayhead=this.getPlayhead(),e.adLanguage=this.getLanguage(),e.adSrc=this.getSrc(),e.adCdn=this.getCdn(),e.adIsMuted=this.isMuted(),e.adFps=this.getFps(),e.adQuartile=this.getAdQuartile(),e.adPosition=this.getAdPosition(),e.adCreativeId=this.getAdCreativeId(),e.adPartner=this.getAdPartner()):(e.contentId=this.getVideoId(),e.contentTitle=this.getTitle(),e.contentIsLive=this.isLive(),e.contentBitrate=this.getBitrate()||this.getWebkitBitrate(),e.contentRenditionName=this.getRenditionName(),e.contentRenditionBitrate=this.getRenditionBitrate(),e.contentRenditionHeight=this.getRenditionHeight(),e.contentRenditionWidth=this.getRenditionWidth(),e.contentDuration=this.getDuration(),e.contentPlayhead=this.getPlayhead(),e.contentLanguage=this.getLanguage(),e.contentSrc=this.getSrc(),e.contentPlayrate=this.getPlayrate(),e.contentIsFullscreen=this.isFullscreen(),e.contentIsMuted=this.isMuted(),e.contentCdn=this.getCdn(),e.contentIsAutoplayed=this.isAutoplayed(),e.contentPreload=this.getPreload(),e.contentFps=this.getFps()),this.state.getStateAttributes(e),this.customData)e[t]=this.customData[t];return e}},{key:"sendPlayerReady",value:function(e){this.state.goPlayerReady()&&(e=e||{},this.send(i.Events.PLAYER_READY,e))}},{key:"sendRequest",value:function(e){if(this.state.goRequest()){this.state.goViewCountUp();var t=this.isAd()?i.Events.AD_REQUEST:i.Events.CONTENT_REQUEST;this.send(t,e),this.startHeartbeat(),this.state.goHeartbeat()}}},{key:"sendStart",value:function(e){if(this.state.goStart()){var t=this.isAd()?i.Events.AD_START:i.Events.CONTENT_START;this.send(t,e)}}},{key:"sendEnd",value:function(e){if(this.state.goEnd()){e=e||{};var t=void 0;this.isAd()?(t=i.Events.AD_END,e.timeSinceAdRequested=this.state.timeSinceRequested.getDeltaTime(),e.timeSinceAdStarted=this.state.timeSinceStarted.getDeltaTime()):(t=i.Events.CONTENT_END,e.timeSinceRequested=this.state.timeSinceRequested.getDeltaTime(),e.timeSinceStarted=this.state.timeSinceStarted.getDeltaTime()),this.stopHeartbeat(),this.send(t,e),this.parentTracker&&this.isAd()&&this.parentTracker.state.goLastAd(),this.state.goViewCountUp()}}},{key:"sendPause",value:function(e){if(this.state.goPause()){var t=this.isAd()?i.Events.AD_PAUSE:i.Events.CONTENT_PAUSE;this.send(t,e)}}},{key:"sendResume",value:function(e){if(this.state.goResume()){e=e||{};var t=void 0;this.isAd()?(t=i.Events.AD_RESUME,e.timeSinceAdPaused=this.state.timeSincePaused.getDeltaTime()):(t=i.Events.CONTENT_RESUME,e.timeSincePaused=this.state.timeSincePaused.getDeltaTime()),this.send(t,e)}}},{key:"sendBufferStart",value:function(e){if(this.state.goBufferStart()){var t;t=this.isAd()?i.Events.AD_BUFFER_START:i.Events.CONTENT_BUFFER_START,this.send(t,e)}}},{key:"sendBufferEnd",value:function(e){if(this.state.goBufferEnd()){e=e||{};var t=void 0;this.isAd()?(t=i.Events.AD_BUFFER_END,e.timeSinceAdBufferBegin=this.state.timeSinceBufferBegin.getDeltaTime()):(t=i.Events.CONTENT_BUFFER_END,e.timeSinceBufferBegin=this.state.timeSinceBufferBegin.getDeltaTime()),this.send(t,e)}}},{key:"sendSeekStart",value:function(e){if(this.state.goSeekStart()){var t;t=this.isAd()?i.Events.AD_SEEK_START:i.Events.CONTENT_SEEK_START,this.send(t,e)}}},{key:"sendSeekEnd",value:function(e){if(this.state.goSeekEnd()){e=e||{};var t=void 0;this.isAd()?(t=i.Events.AD_SEEK_END,e.timeSinceAdSeekBegin=this.state.timeSinceSeekBegin.getDeltaTime()):(t=i.Events.CONTENT_SEEK_END,e.timeSinceSeekBegin=this.state.timeSinceSeekBegin.getDeltaTime()),this.send(t,e)}}},{key:"sendDownload",value:function(e){(e=e||{}).state||s.default.warn("Called sendDownload without { state: xxxxx }."),this.send(i.Events.DOWNLOAD,e),this.state.goDownload()}},{key:"sendError",value:function(e){(e=e||{}).isAd=!0,this.state.goError();var t=this.isAd()?i.Events.AD_ERROR:i.Events.CONTENT_ERROR;this.send(t,e)}},{key:"sendRenditionChanged",value:function(e){(e=e||{}).timeSinceLastRenditionChange=this.state.timeSinceLastRenditionChange.getDeltaTime(),e.shift=this.getRenditionShift(!0);var t;t=this.isAd()?i.Events.AD_RENDITION_CHANGE:i.Events.CONTENT_RENDITION_CHANGE,this.send(t,e),this.state.goRenditionChange()}},{key:"sendHeartbeat",value:function(e){if(this.state.isRequested){var t;t=this.isAd()?i.Events.AD_HEARTBEAT:i.Events.CONTENT_HEARTBEAT,this.send(t,e),this.state.goHeartbeat()}}},{key:"sendAdBreakStart",value:function(e){this.isAd()&&this.state.goAdBreakStart()&&this.send(i.Events.AD_BREAK_START,e)}},{key:"sendAdBreakEnd",value:function(e){this.isAd()&&this.state.goAdBreakEnd()&&((e=e||{}).timeSinceAdBreakBegin=this.state.timeSinceAdBreakStart.getDeltaTime(),this.send(i.Events.AD_BREAK_END,e))}},{key:"sendAdQuartile",value:function(e){this.isAd()&&((e=e||{}).quartile||s.default.warn("Called sendAdQuartile without { quartile: xxxxx }."),e.timeSinceLastAdQuartile=this.state.timeSinceLastAdQuartile.getDeltaTime(),this.send(i.Events.AD_QUARTILE,e),this.state.goAdQuartile())}},{key:"sendAdClick",value:function(e){this.isAd()&&((e=e||{}).url||s.default.warn("Called sendAdClick without { url: xxxxx }."),this.send(i.Events.AD_CLICK,e))}}]),i}();c.Events={PLAYER_READY:"PLAYER_READY",DOWNLOAD:"DOWNLOAD",ERROR:"ERROR",CONTENT_REQUEST:"CONTENT_REQUEST",CONTENT_START:"CONTENT_START",CONTENT_END:"CONTENT_END",CONTENT_PAUSE:"CONTENT_PAUSE",CONTENT_RESUME:"CONTENT_RESUME",CONTENT_SEEK_START:"CONTENT_SEEK_START",CONTENT_SEEK_END:"CONTENT_SEEK_END",CONTENT_BUFFER_START:"CONTENT_BUFFER_START",CONTENT_BUFFER_END:"CONTENT_BUFFER_END",CONTENT_HEARTBEAT:"CONTENT_HEARTBEAT",CONTENT_RENDITION_CHANGE:"CONTENT_RENDITION_CHANGE",CONTENT_ERROR:"CONTENT_ERROR",AD_REQUEST:"AD_REQUEST",AD_START:"AD_START",AD_END:"AD_END",AD_PAUSE:"AD_PAUSE",AD_RESUME:"AD_RESUME",AD_SEEK_START:"AD_SEEK_START",AD_SEEK_END:"AD_SEEK_END",AD_BUFFER_START:"AD_BUFFER_START",AD_BUFFER_END:"AD_BUFFER_END",AD_HEARTBEAT:"AD_HEARTBEAT",AD_RENDITION_CHANGE:"AD_RENDITION_CHANGE",AD_ERROR:"AD_ERROR",AD_BREAK_START:"AD_BREAK_START",AD_BREAK_END:"AD_BREAK_END",AD_QUARTILE:"AD_QUARTILE",AD_CLICK:"AD_CLICK"},t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnvatoAdsTracker=void 0;var i,a=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),s=n(7),o=n(13),u=(i=o)&&i.__esModule?i:{default:i},c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.VideoTracker),a(t,[{key:"setPlayer",value:function(e,t){"string"==typeof e&&(e="undefined"!=typeof AnvatoPlayer?AnvatoPlayer(e):anvp[e]),r.VideoTracker.prototype.setPlayer.call(this,e)}},{key:"resetValues",value:function(){this.title=null,this.live=null,this.bitrate=null,this.playhead=null,this.duration=null,this.muted=null}},{key:"getTrackerName",value:function(){return"anvato"}},{key:"getTrackerVersion",value:function(){return s.version}},{key:"getPlayhead",value:function(){return this.playhead}},{key:"getDuration",value:function(){return this.duration}},{key:"getRenditionBitrate",value:function(){return this.bitrate}},{key:"getTitle",value:function(){return this.title}},{key:"isMuted",value:function(){return this.muted}},{key:"getPlayerVersion",value:function(){try{return anvp.version}catch(e){return null}}},{key:"isAutoplayed",value:function(){return this.player.config.autoplay}},{key:"loadAdTracker",value:function(){this.setAdsTracker(new u.default(this.player))}},{key:"registerListeners",value:function(){var n=this;if(this.player.on){if(r.Log.level<=r.Log.Levels.DEBUG)for(var i=["ready","PRESENTATION_UPDATED","STATE_CHANGE","CLIENT_BANDWIDTH","FIRST_FRAME_READY","PLAYING_START","VIDEO_STARTED","VIDEO_FIRST_QUARTILE","VIDEO_MID_POINT","VIDEO_THIRD_QUARTILE","VIDEO_COMPLETED","PLAYLIST_COMPLETED","NEXT_PROGRAM","METADATA_LOADED","PLAYER_ERROR","USER_PLAY","USER_RESUME","USER_GOLIVE","USER_PAUSE","USER_FORWARD_SEEK","USER_BACKWARD_SEEK","BUFFER_START","BUFFER_END","BITRATE_CHANGED","BITRATE_CHANGE_IN_PROGRESS","MEDIA_URLS_SET","BEFORE_VIDEO_LOAD","PLAYLIST_ITEM_CHANGED"],a=0;a<i.length;a++)!function(e){var t=i[a];n.player.on(t,function(e){r.Log.debug("Event: "+t,e)})}();this.player.on("ready",this.onReady.bind(this)),this.player.on("METADATA_LOADED",this.onMetadataLoaded.bind(this)),this.player.on("USER_PLAY",this.onUserPlay.bind(this)),this.player.on("PLAYING_START",this.onPlayingStart.bind(this)),this.player.on("USER_PAUSE",this.onUserPause.bind(this)),this.player.on("USER_RESUME",this.onUserResume.bind(this)),this.player.on("USER_FORWARD_SEEK",this.onUserForwardSeek.bind(this)),this.player.on("USER_BACKWARD_SEEK",this.onUserBackwardSeek.bind(this)),this.player.on("BUFFER_END",this.onBufferEnd.bind(this)),this.player.on("BUFFER_START",this.onBufferStart.bind(this)),this.player.on("VIDEO_COMPLETED",this.onVideoCompleted.bind(this)),this.player.on("PLAYER_ERROR",this.onError.bind(this)),this.player.on("BITRATE_CHANGED",this.onBitrateChanged.bind(this)),this.player.on("TIME_UPDATED",this.onTimeUpdated.bind(this)),this.player.on("MUTED",this.onMuted.bind(this)),this.player.on("UNMUTED",this.onUnmuted.bind(this))}}},{key:"unregisterListeners",value:function(){this.player.off&&(this.player.off("ready",this.onReady),this.player.off("METADATA_LOADED",this.onMetadataLoaded),this.player.off("USER_PLAY",this.onUserPlay),this.player.off("PLAYING_START",this.onPlayingStart),this.player.off("USER_PAUSE",this.onUserPause),this.player.off("USER_RESUME",this.onUserResume),this.player.off("USER_FORWARD_SEEK",this.onUserForwardSeek),this.player.off("USER_BACKWARD_SEEK",this.onUserBackwardSeek),this.player.off("BUFFER_END",this.onBufferEnd),this.player.off("BUFFER_START",this.onBufferStart),this.player.off("VIDEO_COMPLETED",this.onVideoCompleted),this.player.off("PLAYER_ERROR",this.onError),this.player.off("BITRATE_CHANGED",this.onBitrateChanged),this.player.off("TIME_UPDATED",this.onTimeUpdated),this.player.off("MUTED",this.onMuted),this.player.off("UNMUTED",this.onUnmuted))}},{key:"processEvent",value:function(e){switch(r.Log.level<=r.Log.Levels.DEBUG&&r.Log.debug("Event:",e),this.adsTracker&&this.adsTracker.processEvent(e),e.name){case"METADATA_LOADED":this.onMetadataLoaded.apply(this,e.args);break;case"USER_PLAY":this.onUserPlay.apply(this,e.args);break;case"PLAYING_START":this.onPlayingStart.apply(this,e.args);break;case"USER_PAUSE":this.onUserPause.apply(this,e.args);break;case"USER_RESUME":this.onUserResume.apply(this,e.args);break;case"USER_FORWARD_SEEK":this.onUserForwardSeek.apply(this,e.args);break;case"USER_BACKWARD_SEEK":this.onUserBackwardSeek.apply(this,e.args);break;case"BUFFER_END":this.onBufferEnd.apply(this,e.args);break;case"BUFFER_START":this.onBufferStart.apply(this,e.args);break;case"VIDEO_COMPLETED":this.onVideoCompleted.apply(this,e.args);break;case"PLAYER_ERROR":this.onError.apply(this,e.args);break;case"BITRATE_CHANGED":this.onBitrateChanged.apply(this,e.args);break;case"TIME_UPDATED":this.onTimeUpdated.apply(this,e.args);break;case"MUTED":this.onMuted.apply(this,e.args);break;case"UNMUTED":this.onUnmuted.apply(this,e.args)}}},{key:"onMetadataLoaded",value:function(e,t,n){this.title=n.title,this.live=n.live}},{key:"onReady",value:function(){this.loadAdTracker(),this.sendPlayerReady()}},{key:"onUserPlay",value:function(){var t=this;this.player.getDuration(function(e){t.duration=1e3*e}),this.sendRequest()}},{key:"onPlayingStart",value:function(){var t=this;this.player.getDuration(function(e){t.duration=1e3*e}),this.sendStart()}},{key:"onUserPause",value:function(){this.sendPause()}},{key:"onUserResume",value:function(){this.sendResume()}},{key:"onUserForwardSeek",value:function(){this.sendSeekStart()}},{key:"onUserBackwardSeek",value:function(){this.sendSeekStart()}},{key:"onBufferStart",value:function(){this.state.isSeeking||this.sendBufferStart()}},{key:"onBufferEnd",value:function(){this.state.isSeeking&&this.sendSeekEnd(),this.state.isBuffering&&this.sendBufferEnd()}},{key:"onVideoCompleted",value:function(){this.sendEnd(),this.resetValues()}},{key:"onError",value:function(e,t,n){this.sendError({errorCode:e,errorMsg:t,errorIsFatal:n}),n&&this.sendEnd()}},{key:"onBitrateChanged",value:function(e){this.bitrate=1e3*e,this.sendRenditionChanged()}},{key:"onTimeUpdated",value:function(e){this.adsTracker&&this.adsTracker.state.isRequested||(this.playhead=1e3*e)}},{key:"onMuted",value:function(){this.muted=!0}},{key:"onUnmuted",value:function(){this.muted=!1}}]),t}();t.default=c,t.AnvatoAdsTracker=u.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(0)),a=n(7),s=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.VideoTracker),i(t,[{key:"resetValues",value:function(){this.playhead=null,this.id=null,this.provider=null,this.title=null,this.duration=null}},{key:"getTrackerName",value:function(){return"anvato-ads"}},{key:"getTrackerVersion",value:function(){return a.version}},{key:"getDuration",value:function(){return this.duration}},{key:"getVideoId",value:function(){return this.id}},{key:"getAdPartner",value:function(){return this.provider}},{key:"getPlayhead",value:function(){return this.playhead}},{key:"getTitle",value:function(){return this.title}},{key:"registerListeners",value:function(){var n=this;if(this.player.on){if(r.Log.level<=r.Log.Levels.DEBUG)for(var i=["AD_BREAKS","AD_BREAK_STARTED","AD_STARTED","AD_FIRST_QUARTILE","AD_MID_POINT","AD_THIRD_QUARTILE","AD_COMPLETED","AD_BREAK_COMPLETED","AD_SKIPPED","ALL_ADS_COMPLETED","AD_CLICKED","COMPANION_AVAILABLE","NON_LINEAR_AD_DISPLAYED","AD_IMMINENT","POPUP_DISPLAYED","POPUP_BLOCKED"],a=0;a<i.length;a++)!function(e){var t=i[a];n.player.on(t,function(e){r.Log.debug("Event: "+t,e)})}();this.player.on("AD_BREAK_STARTED",this.onAdBreakStart.bind(this)),this.player.on("AD_BREAK_COMPLETED",this.onAdBreakCompleted.bind(this)),this.player.on("AD_FIRST_QUARTILE",this.onFirstQuartile.bind(this)),this.player.on("AD_MID_POINT",this.onMidPoint.bind(this)),this.player.on("AD_THIRD_QUARTILE",this.onThirdQuartile.bind(this)),this.player.on("AD_CLICKED",this.onClick.bind(this)),this.player.on("AD_STARTED",this.onAdStarted.bind(this)),this.player.on("AD_COMPLETED",this.onCompleted.bind(this)),this.player.on("AD_SKIPPED",this.onSkipped.bind(this)),this.player.on("TIME_UPDATED",this.onTimeUpdated.bind(this))}}},{key:"unregisterListeners",value:function(){this.player.off&&(this.player.off("AD_BREAK_STARTED",this.onAdBreakStart),this.player.off("AD_BREAK_COMPLETED",this.onAdBreakCompleted),this.player.off("AD_FIRST_QUARTILE",this.onFirstQuartile),this.player.off("AD_MID_POINT",this.onMidPoint),this.player.off("AD_THIRD_QUARTILE",this.onThirdQuartile),this.player.off("AD_CLICKED",this.onClick),this.player.off("AD_STARTED",this.onAdStarted),this.player.off("AD_COMPLETED",this.onCompleted),this.player.off("AD_SKIPPED",this.onSkipped),this.player.off("TIME_UPDATED",this.onTimeUpdated))}},{key:"processEvent",value:function(e){switch(e.name){case"AD_BREAK_STARTED":this.onAdBreakStart.apply(this,e.args);break;case"AD_BREAK_COMPLETED":this.onAdBreakCompleted.apply(this,e.args);break;case"AD_FIRST_QUARTILE":this.onFirstQuartile.apply(this,e.args);break;case"AD_MID_POINT":this.onMidPoint.apply(this,e.args);break;case"AD_THIRD_QUARTILE":this.onThirdQuartile.apply(this,e.args);break;case"AD_CLICKED":this.onClick.apply(this,e.args);break;case"AD_STARTED":this.onAdStarted.apply(this,e.args);break;case"AD_COMPLETED":this.onCompleted.apply(this,e.args);break;case"AD_SKIPPED":this.onSkipped.apply(this,e.args);break;case"TIME_UPDATED":this.onTimeUpdated.apply(this,e.args)}}},{key:"onAdBreakStart",value:function(){this.sendAdBreakStart()}},{key:"onAdBreakCompleted",value:function(){this.sendAdBreakEnd()}},{key:"onFirstQuartile",value:function(){this.sendAdQuartile({quartile:1})}},{key:"onMidPoint",value:function(){this.sendAdQuartile({quartile:2})}},{key:"onThirdQuartile",value:function(){this.sendAdQuartile({quartile:3})}},{key:"onAdStarted",value:function(e,t,n){var i=this;this.id=e,this.title=t,this.provider=n,this.player.getAdDuration(function(e){i.duration=e}),this.sendRequest(),this.sendStart()}},{key:"onTimeUpdated",value:function(e){this.state.isRequested&&(this.playhead=1e3*e)}},{key:"onSkipped",value:function(e){this.sendEnd({skipped:!0}),this.resetValues()}},{key:"onCompleted",value:function(e){this.sendEnd(),this.resetValues()}},{key:"onClick",value:function(e){this.sendAdClick()}}]),t}();t.default=s}])},"object"==typeof n&&"object"==typeof t?t.exports=a():"object"==typeof n?n.nrvideo=a():i.nrvideo=a()},{}],12:[function(e,t,n){var c=e("./util/parse-settings.js"),l=e("./bindings/ready.js"),d=e("./bindings/before-video-load.js"),f=e("./extensions/newrelic.min.js"),h=e("./extensions/chartbeat/bind-meta.js"),p=e("./util/init-plugins.js"),g=e("./util/parse-attribute.js"),v=e("./util/player-cache.js"),y=e("./extensions/cmg.js");t.exports=function(e,t){var n=c(t),i=window.AnvatoPlayer(e);l(i,n.muted),d(i,e,t);var a,r,s={playlist:t.getAttribute("data-videoid").split(","),accessKey:t.getAttribute("data-access-key")||y.anvatoConf.accessKey,autoplay:n.autoplay,recom:n.recom},o=t.attributes.length;for(a=0;a<o;a+=1){if(0===(r=t.attributes[a]).name.indexOf("data-anv-"))s[r.name.substr(9).replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})]=g(r.value)}var u=p.get(e);return u&&(s.plugins=u),i.init(s),v.add(e,i),window.newrelic?f.Core.addTracker(new f.AnvatoTracker(e)):console.warn("[cmAnvato] Cannot find newrelic object! Video tracking is OFFLINE."),h(i),i}},{"./bindings/before-video-load.js":3,"./bindings/ready.js":4,"./extensions/chartbeat/bind-meta.js":5,"./extensions/cmg.js":8,"./extensions/newrelic.min.js":11,"./util/init-plugins.js":19,"./util/parse-attribute.js":23,"./util/parse-settings.js":24,"./util/player-cache.js":25}],13:[function(e,t,n){var r=e("./load-player.js"),i=e("./util/environment-options.js").stage?"stage":"prod",s=e("./util/id-factory.js");function a(){var e,t,n,i=document.getElementsByClassName("anvato-player"),a=i.length;for(e=0;e<a;e+=1)n=(t=i[0]).id?t.id:t.id="p"+s.next(),r(n,t)}t.exports=function(){if(window.AnvatoPlayer)a();else{var e=document.createElement("script");e.src="https://w3.cdn.anvato.net/player/"+i+"/v3/scripts/anvload.js",e.onload=a,document.body.appendChild(e)}}},{"./load-player.js":12,"./util/environment-options.js":16,"./util/id-factory.js":18}],14:[function(e,t,n){t.exports=function(){var n=window.anvp=window.anvp||{};n.getAll&&n.getAll().forEach(function(e){var t=n[e];t&&t.pause&&t.pause()})}},{}],15:[function(e,t,n){var i=e("./util/map-merge-left.js"),a=window.anvp=window.anvp||{},r=window.DDO,s=e("./util/environment-options.js"),o=e("./util/moat-option.js");a.common=a.common||{},a.common.config=i({autoplay:!1,height:"56.25%",mcp:"anv",overlay:{marginBottom:"55px"},profile:"cox",recom:!("recom"in s)||s.recom,token:" ",trackTimePeriod:!0,volume:"volume"in s?s.volume:.5,width:"100%"},a.common.config);var u={comscore:{clientId:/ajc.com$/.test(window.location.hostname)?6035944:32816940,script:"//w3.cdn.anvato.net/player/prod/v3/plugins/comscore/comscoreplugin.min.js"},dfp:{clientSide:{adTagUrl:"https://pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=[adunit]&gdfp_req=1&ad_rule=1&env=vp&output=vast&description_url=[referrer_url]&content_page_url=[referrer_url]&vid=[vid]&cmsid=[cmsid]"}}};o&&(u.moat={clientSide:{partnerCode:"coxmediagroupvidint348266005452"}}),a.common.config.plugins=i(u,a.common.config.plugins),r&&r.pageData&&r.siteData&&r.contentData&&(a.common.config.customMetadata={video:{pageName:r.pageData.pageName,pageSiteSection:r.pageData.pageSiteSection,pageCategory:r.pageData.pageCategory,pageSubCategory:r.pageData.pageSubCategory,pageContentType:r.pageData.pageContentType,pageTitle:r.pageData.pageTitle,siteVersion:r.siteData.siteVersion,siteDomain:r.siteData.siteDomain,siteFormat:r.siteData.siteFormat,siteMetro:r.siteData.siteMetro,siteMedium:r.siteData.siteMedium,siteID:r.siteData.siteID,siteType:r.siteData.siteType,siteCMS:r.siteData.siteCMS,contentTopics:r.contentData.contentTopics,contentByline:r.contentData.contentByline,contentID:r.contentData.contentID,contentVendor:r.contentData.contentVendor},chapter:{},ad:{}})},{"./util/environment-options.js":16,"./util/map-merge-left.js":20,"./util/moat-option.js":21}],16:[function(e,t,n){var a={},i={},r=window.location.search;0<=r.indexOf("anvato")&&((r=r.slice(1)).split("&").forEach(function(e){var t=e.split("="),n=t[0],i=t[1];a[n]=!i||window.decodeURIComponent(i)}),a.anvato.split("|").forEach(function(e){e=e.split("-"),i[e[0]]=e[1]||!0})),t.exports=i},{}],17:[function(e,t,n){var i={},a={};t.exports={on:function(e,t){i[e]=i[e]||[],i[e].push(t),e in a&&t(a[e])},trigger:function(e,t){a[e]=t,e in i&&i[e].forEach(function(e){e(t)})}}},{}],18:[function(e,t,n){var i=-1;t.exports={next:function(){return i+=1},current:function(){return i}}},{}],19:[function(e,t,n){var i={};t.exports={set:function(e,t){i[e]=t},get:function(e){return i[e]}}},{}],20:[function(e,t,n){t.exports=function(e,t){var n;for(n in e=e||{},t=t||{})e[n]=t[n];return e}},{}],21:[function(e,t,n){var i=!1,a=document.getElementsByClassName("anvatoEnableMoat");if(a.length){a=a[0];try{var r=a.getAttribute("data-value")||!1;i=JSON.parse(r)}catch(e){console.error(e.name,e.message,"\n\t- value:",r)}}t.exports=i},{}],22:[function(e,t,n){t.exports=function(e){if(Object.values)return Object.values(e);var t,n=[];for(t in e)n.push(e[t]);return n}},{}],23:[function(e,t,n){t.exports=function(e){return"true"===e||"false"!==e&&e}},{}],24:[function(e,t,n){var r=e("./environment-options.js");t.exports=function(e){var t=e.getAttribute("data-topics")||"",n="true"===e.getAttribute("data-autoplay"),i="true"===e.getAttribute("data-muted"),a="true"===e.getAttribute("data-recom");return 0<=(t=t.split(",")).indexOf("autoplay-on-sound-on")&&(i=!(n=!0)),{autoplay:"autoplay"in r?"true"===r.autoplay:n,muted:"mute"in r?"true"===r.mute:i,recom:"recom"in r?"true"===r.recom:a}}},{"./environment-options.js":16}],25:[function(e,t,n){var i=e("./object-values.js"),a={},r={};t.exports={get:function(e,t){e?e in a?t(a[e]):(r[e]=r[e]||[],r[e].push(t)):t(i(a))},add:function(e,t){a[e]=t,e in r&&(r[e].forEach(function(e){e(t)}),r[e]=[])}}},{"./object-values.js":22}],26:[function(e,t,n){t.exports=function(e){return e.tags=e.tags||[],e.categories=e.categories||[],e.upload_id=e.upload_id||e.id||"ERROR",e.owner_id=e.owner_id||"ERROR",e}},{}]},{},[2])(2)});